Starting epoch 1/100...
Epoch 1:   0%|                                               | 0/42476 [00:00<?, ?it/s]Exception in thread Thread-5 (_pin_memory_loop):
Global Max: 0.12886852025985718
Traceback (most recent call last):                     | 2/188 [00:16<23:19,  7.52s/it]
  File "/root/miniconda3/envs/rewas/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/root/miniconda3/envs/rewas/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/root/miniconda3/envs/rewas/lib/python3.10/site-packages/torch/utils/data/_utils/pin_memory.py", line 59, in _pin_memory_loop
    do_one_step()
  File "/root/miniconda3/envs/rewas/lib/python3.10/site-packages/torch/utils/data/_utils/pin_memory.py", line 35, in do_one_step
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/root/miniconda3/envs/rewas/lib/python3.10/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/root/miniconda3/envs/rewas/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 541, in rebuild_storage_fd
    fd = df.detach()
  File "/root/miniconda3/envs/rewas/lib/python3.10/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/root/miniconda3/envs/rewas/lib/python3.10/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/root/miniconda3/envs/rewas/lib/python3.10/multiprocessing/connection.py", line 502, in Client
    c = SocketClient(address)
  File "/root/miniconda3/envs/rewas/lib/python3.10/multiprocessing/connection.py", line 630, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory
Evaluating:   1%|▍                                     | 2/188 [00:18<29:09,  9.41s/it]
Epoch 1:   0%|                                               | 0/42476 [01:30<?, ?it/s]
Traceback (most recent call last):
  File "/workspace/rewas/./train_miil.py", line 329, in <module>
    main(args)
  File "/workspace/rewas/./train_miil.py", line 248, in main
    avg_loss1, avg_loss2, avg_loss3, avg_iou1, avg_iou2, avg_iou3 = evaluate(phi, video_encoder, test_loader, synchformer_cfg.training.use_half_precision)
  File "/workspace/rewas/evaluate_cam.py", line 59, in evaluate
    hint, _, hint_mask = video_encoder(video, for_loop=False, cont_mask=attention_mask)
  File "/root/miniconda3/envs/rewas/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/rewas/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/rewas/encoder/model/modules/feat_extractors/visual/motionformer.py", line 214, in forward
    x, x_mask = self.forward_segments(x, orig_shape=orig_shape, cont_mask=cont_mask)
  File "/workspace/rewas/encoder/model/modules/feat_extractors/visual/motionformer.py", line 231, in forward_segments
    x, x_mask = self.forward_features(x, cont_mask=cont_mask)
  File "/workspace/rewas/./encoder/model/modules/feat_extractors/visual/motionformer_src/video_model_builder.py", line 269, in forward_features
    x = blk(x, seq_len=npatch, num_frames=self.temporal_resolution,
  File "/root/miniconda3/envs/rewas/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/rewas/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/rewas/./encoder/model/modules/feat_extractors/visual/motionformer_src/vit_helper.py", line 370, in forward
    space_output = self.attn(self.norm1(time_residual), self.einops_from_space, self.einops_to_space,
  File "/root/miniconda3/envs/rewas/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/rewas/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/rewas/./encoder/model/modules/feat_extractors/visual/motionformer_src/vit_helper.py", line 124, in forward
    cls_out = qkv_attn(cls_q, k, v, tok_mask=tok_mask)
  File "/workspace/rewas/./encoder/model/modules/feat_extractors/visual/motionformer_src/vit_helper.py", line 41, in qkv_attn
    out = einsum('b i j, b j d -> b i d', attn, v)
  File "/root/miniconda3/envs/rewas/lib/python3.10/site-packages/torch/functional.py", line 402, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
KeyboardInterrupt
